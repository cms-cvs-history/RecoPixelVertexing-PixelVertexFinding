process Simulation = 
{

  # initialize  MessageLogger
  include "RecoTracker/RoadSearchCloudMaker/test/messages.cfi"
 
  # initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # geometry (switched to tracker only geometry)
  #include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  es_source = XMLIdealGeometryESSource 
  {
    FileInPath GeometryConfiguration="Geometry/TrackerSimData/data/trackerSimConfiguration.xml"
    string rootNodeName = ""
  }

  # tracker geometry
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # tracker numbering
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  service = RandomNumberGeneratorService
  {
    untracked uint32 sourceSeed = 98765
  }

  source = PythiaSource
  { 
    untracked int32 maxEvents = 10
    untracked bool pythiaVerbosity = false

    PSet PythiaParameters = 
    {

      vstring parameterSets = 
      {
        "pythiabb120170"
      }

      vstring pythiabb120170 = 
      {
       "MSEL=1            !()",
       "MSTJ(11)=3            !Choice of the fragmentation function",
       "MSTJ(22)=2            !Decay those unstable particles",
       "MSTP(2)=1            !which order running alphaS",
       "MSTP(51)=7            !structure function chosen",
       "MSTP(81)=1            !multiple parton interactions 1 is Pythia default",
       "MSTP(82)=4            !Defines the multi-parton model",
       "MSTU(21)=1            !Check on possible errors during program execution",
       "PARJ(71)=10.            !for which ctau  10 mm",
       "PARP(82)=1.9            !pt cutoff for multiparton interactions",
       "PARP(89)=1000.            !sqrts for which PARP82 is set",
       "PARP(84)=0.4            !Multiple interactions: matter distribution parameter Registered by Chris.Seez@cern.ch",
       "CKIN(3)=120.            !(DGeV)",
       "CKIN(4)=170.            !(D-1. GeV) maximum pt hat for hard interactions GeV/c",
       "!KSEL=430            !",
       "!NSEL=500            !maximal number of subevents per AA event Registered by Olga.Kodolova@cern.ch",
       "!TRIG=1000000            !maximum number of tries",
       "!ECMS=14000.            !Energy per nucleon (can differ for different nuclei from 5.5 TeV to 7 TeV) Registered by Olga.Kodolova@cern.ch"

      }
    }
  }

  # include geant4 simulation
  include "SimG4Core/Application/data/SimG4Object.cfi"

  module Out = PoolOutputModule 
  { 
    untracked string fileName = "simevents_pythiabb120170.root"
  }

  path p = 
  {
    g4SimHits
  }

  endpath e = 
  {
    Out
 }
}
